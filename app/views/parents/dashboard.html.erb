<div class="container mx-auto px-4 py-8">
  <h1 class="text-2xl font-bold mb-6">保護者ダッシュボード</h1>

  <div class="space-y-8">
    <% @children.each do |child| %>
      <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-semibold mb-4"><%= child.name %>のメモ</h2>
        
        <div class="space-y-4">
          <% child.memos.order(created_at: :desc).each do |memo| %>
            <div class="border rounded-lg p-4">
              <div class="flex justify-between items-start">
                <div class="flex-1">
                  <h3 class="text-lg font-medium"><%= memo.title %></h3>
                  <p class="text-gray-600 mb-2">カテゴリ: <%= memo.category %></p>
                  <p class="text-gray-700"><%= memo.body %></p>
                  
                  <% if memo.images.attached? %>
                    <div class="flex flex-wrap gap-2 mt-2">
                      <% memo.images.each do |image| %>
                        <div class="w-20 h-20">
                          <%= image_tag image, class: 'w-full h-full object-cover rounded' %>
                        </div>
                      <% end %>
                    </div>
                  <% end %>
                </div>
                <div class="ml-2 flex-shrink-0 flex">
                  <%= link_to "コメントを書く", new_memo_comment_path(memo), class: "text-indigo-600 hover:text-indigo-900" %>
                </div>
              </div>
              <div class="mt-2 sm:flex sm:justify-between">
                <div class="sm:flex">
                  <p class="flex items-center text-sm text-gray-500">
                    <%= l memo.created_at, format: :short %>
                  </p>
                </div>
              </div>

              <% if memo.comments.any? %>
                <div class="mt-4 space-y-2">
                  <% memo.comments.each do |comment| %>
                    <div class="bg-gray-50 rounded p-3">
                      <p class="text-sm text-gray-700"><%= comment.body %></p>
                      <p class="text-xs text-gray-500 mt-1">
                        <%= l comment.created_at, format: :short %>
                      </p>
                    </div>
                  <% end %>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
